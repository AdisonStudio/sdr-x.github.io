---
date: 2014-05-29 12:00:00
layout: post
title: Some efforts on GPS signal replay (GPS重放)
thread: 10245
categories: GPS
tags:  HACKRF GPS replay CA-code L5 L1 SDR Software-Defined-Radio hackrf_transfer rtl-sdr rtl2832
---

Some efforts were put on replaying GPS signal, but it is only partial successful, not fully successful. Some tools/scripts are useful.

See codes here: [https://github.com/JiaoXianjun/GNSS-GPS-SDR](https://github.com/JiaoXianjun/GNSS-GPS-SDR)

To build the C program "gps_test" after you get the whole repo:

    make

**----------------------offline GPS simulation method---------------------**

**use Matlab to generate GPS signal, then receive it by C program gps_test**

    gps_test gps_sig_tmp.bin 2.046e6 8.184e6 5000

Above program gps_test performs initial GPS signal capture by multi-bins correlation in frequency domain.

gps_sig_tmp.bin: input GPS signal, and can be generated by gps_sig_gen.m (MATLAB).

2.046e6: carrier frequency

8.184e6: sampling rate

5000: maximum frequency offset for frequency searching

**use gps_test to receive GPS signal captured by others instead of my our Matlab script gps_sig_gen.m**

    gps_test gps.samples.1bit.I.fs5456.if4092.bin 4.092e6 5.456e6 5000

gps.samples.1bit.I.fs5456.if4092.bin: captured by others and can be downloaded here: [http://www.jks.com/gps/gps.html](http://www.jks.com/gps/gps.html)

**-------------------------over the air test method--------------------------**

**1. playback gps.samples.1bit.I.fs5456.if4092.bin( [http://www.jks.com/gps/gps.html](http://www.jks.com/gps/gps.html) )**

a. run gps_bin1bit_log2bin.m in Matlab to generate playback file for HACKRF: gps.samples.8bit.IQ.fs5456.baseband.bin

b. run gps_Nottingham.grc to playback gps.samples.8bit.IQ.fs5456.baseband.bin over the air.

c. use rtl-sdr to capture signal: 

    rtl_sdr -g 60 -f 1575.42e6 -s 2.8e6 -n 19.2e6 rtl_2.8Msps_1575.42MHz.bin

d. run proc_rtl_bin_for_gps('rtl_2.8Msps_1575.42MHz.bin') in Matlab to get 1bit bin to feed into gps_test program

see C/A initial capture result: 

    gps_test rtl_2.8Msps_1575.42MHz_1bit.bin 0.62e6 2.8e6 100000

You will find C/A codes results are equal to those shown here: [http://www.jks.com/gps/gps.html](http://www.jks.com/gps/gps.html)

**2. playback gps_sig_tmp_for_hackrf_tx.bin (generated by gps_sig_gen.m) to air by gps.grc.**

a. run gps.grc to playback gps_sig_tmp_for_hackrf_tx.bin over the air.

b. capture air signal by:

    rtl_sdr -g 60 -f 1574.8e6 -s 2.8e6 -n 19.2e6 rtl_2.8Msps_1574.8MHz.bin

c. convert captured file to 1bit bin file which is needed by gps_test:

    proc_rtl_bin_for_gps('rtl_2.8Msps_1574.8MHz.bin'); (MATLAB)

d. RUN: 

    gps_test rtl_2.8Msps_1574.8MHz_1bit.bin 0.62e6 2.8e6 100000

to see GPS signal capture result.

e. you can also try to capture air signal with different intermediate frequency by:

    rtl_sdr -g 60 -f 1575.42e6 -s 2.8e6 -n 19.2e6 rtl_2.8Msps_1575.42MHz.bin

f. convert captured file to 1bit bin file which is needed by gps_test:

    proc_rtl_bin_for_gps('rtl_2.8Msps_1575.42MHz.bin'); (MATLAB)

g. RUN: 

    gps_test rtl_2.8Msps_1575.42MHz_1bit.bin 0.62e6 2.8e6 100000
    
to see GPS signal capture result.
